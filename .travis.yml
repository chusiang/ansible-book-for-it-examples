language: bash
sudo: required
services:
  - docker

before_install:
  - docker version
  - ls

jobs:
  include:

    # ---- Ch02 ---------------------------------------------------------------

    # Ansible v2.4
    - stage: Ch02
      script:

        - echo "==> [v2.4] Show version ..."
        - docker run --rm -it chusiang/ansible:2.4 ansible --version

        - echo "==> [v2.4] Check syntax ..."
        - docker run --rm -it -v $PWD:/srv chusiang/ansible:2.4 /bin/sh -c "cd ch02 && ansible-playbook --syntax-check *.yml"

        - echo "==> [v2.4] Run ..."
        - docker run --rm -it -v $PWD:/srv chusiang/ansible:2.4 /bin/sh -c "cd ch02 && ansible-playbook *.yml"

    # Ansible v2.5
    - stage: Ch02
      script:

        - echo "==> [v2.5] Show version ..."
        - docker run --rm -it chusiang/ansible:2.5 ansible --version

        - echo "==> [v2.5] Check syntax ..."
        - docker run --rm -it chusiang/ansible:2.5 ansible --version
        - docker run --rm -it -v $PWD:/srv chusiang/ansible:2.5 /bin/sh -c "cd ch02 && ansible-playbook --syntax-check *.yml"

        - echo "==> [v2.5] Run ..."
        - docker run --rm -it -v $PWD:/srv chusiang/ansible:2.5 /bin/sh -c "cd ch02 && ansible-playbook *.yml"

    # ---- Ch02-1 -------------------------------------------------------------

    - stage: Ch02-1
      script:

        - echo "TBD"

    # ---- Ch02-2-1 -----------------------------------------------------------

    - stage: Ch02-2-1
      script:

        - echo "TBD"
